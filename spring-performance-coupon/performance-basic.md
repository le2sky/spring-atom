#### 서버 성능 지표

- 서버 성능 기본 지표는 대표적으로 응답 시간과 처리량이다.
- 처리량은 TPS, RPS가 대표적이다.
- RPS와 TPS의 차이
    - RPS : 시스템 초당 처리 요청 수
    - TPS : 시스템 초당 처리 트랜잭션 수
    - RPS는 시스템 요청 처리 능력을 측정하며, TPS는 더욱 복잡한 트랜잭션 처리 능력을 측정한다.
- 응답 시간은 클라이언트가 요청을 해서, 처리 결과를 받을 때까지의 시간이다.
    - 응답 시간은 처리 시간과 대기 시간(데이터를 주고 받는데 사용되는 시간)

#### TPS를 높이려면?(처리량)

- 서버를 늘린다. 단순하게 서버 1대가 10 TPS면, 2대면 20 TPS
- 스레드 풀 + DB 커넥션 풀 늘리기
    - 동시 처리 수
        - ex) 스레드 풀 5, 처리 시간 1초 -> TPS 5
        - ex) 스레드 풀 10, 처리 시간 1초 -> TPS 10

#### (중요) 서버 늘리기/스레드 풀 늘리기 한계

- DB에 대한 부하가 임계치를 넘어가면 먹통 증상이 발생한다.
- DB 쿼리 시간이 증가하고, 처리 시간이 길어지면서 TPS가 떨어진다.

#### TPS를 제대로 높이려면?

- 기본적으로 처리 시간을 줄여야 한다.
- 처리시간 1초, 스레드풀 10 -> 10 TPS
- 처리시간 0.5초, 스레드 풀 10 -> 20 TPS

#### 처리 시간을 줄이려면 무엇을 해야하는가?

- 처리 시간에서 비중이 높은 대상을 찾아 줄여야 한다.
- 비중이 높은 대상
    - DB 연동
    - API 호출
    - 데이터 집계/계산

#### 처리 시간 줄이기 : DB

- 쿼리 튜닝
- 캐싱
- 장비빨 : 1 Primary/Replica 읽기 전용 DB, 2 하드웨어 업그레이드 -> 트래픽이 늘면 읽기 DB를 늘린다.

#### 처리 시간 줄이기 : API 호출

- API 호출 응답 시간 증가 -> 처리 시간 증가
- API 호출 성능 개선 방법 2가지
    - 캐싱
    - 호출 제거 : 메시징 + 비동기 연동

#### 처리 시간 줄이기 : 데이터 집계/계산

- 미리 계산해서 캐시나 DB에 보관하기
- 통계류 : ex) 좋아요 수

#### 응답 시간 줄이기

- 처리 시간과 대기 시간 = 응답 시간
- 대기 시간도 마찬가지로 줄여야 한다.

#### 대기 시간 줄이기 : 대역폭

- 대역폭이 작으면 클라이언트 개수가 증가할 때 주고 받는 속도가 급격히 느려진다.
    - ex) 고속도로에 차가 증가하면 속도가 느려지는 것과 유사하다.
- 세 가지 방식 고려
    - 응답 크기 줄이기 : 응답 압축, 이미지 파일 크기 줄이기
    - 트래픽 분리하기 : 이미지, 정적 파일을 CDN을 통해 제공
    - 대역폭 늘리기 (비용 측면에서 CDN이 유리)
